<?php
include "include/header.php";
include "include/sidebar.php";
include "include/topbar.php";
?>
<!-- DashBoard Cards -->
<div class="cards">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-6 col-lg-4 col-xl-3">
                <div class="card" style="background: linear-gradient(to right, #4568dc  , #185a9d);">
                    <div class="card-body">
                        <div class="top py-2 d-flex justify-content-between align-items-lg-stretch">
                            <div class="img">
                                <img src="./img/1594481.png" alt="" srcset="">
                            </div>
                            <div class="text">
                                <h4>DEBIT</h4>
                            </div>
                        </div>
                        <div class="middle py-2 d-flex justify-content-between">
                            <div class="text">
                                <h4><span><i class='bx bx-dollar'></i></span><span class="counter_up" id="loan_giving"></span></h4>
                            </div>
                            <div class="img">
                                <img src="./img/card chip.png" alt="" srcset="">
                            </div>
                        </div>
                        <div class="bottom pt-2 d-flex justify-content-between">
                            <div class="text cvv">
                                <h4>Card Holder</h4>
                                <h3>ঋণ প্রদান</h3>
                            </div>
                            <div class="text d-flex">
                                <div class="cvv">
                                    <h4>Expiry</h4>
                                    <h3>08/26</h3>
                                </div>
                                <div class="cvv mx-2">
                                    <h4>CVV</h4>
                                    <h3>799</h3>
                                </div>
                                <div class="img">
                                    <img src="./img/visa.png" alt="" srcset="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 col-xl-3">
                <div class="card" style="background: linear-gradient(to right, #614385 , #516395);">
                    <div class="card-body">
                        <div class="top py-2 d-flex justify-content-between">
                            <div class="img">
                                <img src="./img/1594481.png" alt="" srcset="">
                            </div>
                            <div class="text">
                                <h4>CREDIT</h4>
                            </div>
                        </div>
                        <div class="middle py-2 d-flex justify-content-between">
                            <div class="text">
                                <h4><span><i class='bx bx-dollar'></i></span"><span class="counter_up" id="loan_rec"></span></h4>
                            </div>
                            <div class="img">
                                <img src="./img/card chip.png" alt="" srcset="">
                            </div>
                        </div>
                        <div class="bottom pt-2 d-flex justify-content-between">
                            <div class="text cvv">
                                <h4>Card Holder</h4>
                                <h3>ঋণ আদায়</h3>
                            </div>
                            <div class="text d-flex">
                                <div class="cvv">
                                    <h4>Expiry</h4>
                                    <h3>08/26</h3>
                                </div>
                                <div class="cvv mx-2">
                                    <h4>CVV</h4>
                                    <h3>952</h3>
                                </div>
                                <div class="img">
                                    <img src="./img/master card.png" alt="" srcset="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 col-xl-3">
                <div class="card" style="background: linear-gradient(to right, #42275a , #734b6d);">
                    <div class="card-body">
                        <div class="top py-2 d-flex justify-content-between">
                            <div class="img">
                                <img src="./img/1594481.png" alt="" srcset="">
                            </div>
                            <div class="text">
                                <h4>CREDIT</h4>
                            </div>
                        </div>
                        <div class="middle py-2 d-flex justify-content-between">
                            <div class="text">
                                <h4><span><i class='bx bx-dollar'></i></span><span class="counter_up" id="dps_rec"></span></h4>
                            </div>
                            <div class="img">
                                <img src="./img/card chip.png" alt="" srcset="">
                            </div>
                        </div>
                        <div class="bottom pt-2 d-flex justify-content-between">
                            <div class="text cvv">
                                <h4>Card Holder</h4>
                                <h3>ডিপিএস</h3>
                            </div>
                            <div class="text d-flex">
                                <div class="cvv">
                                    <h4>Expiry</h4>
                                    <h3>08/26</h3>
                                </div>
                                <div class="cvv mx-2">
                                    <h4>CVV</h4>
                                    <h3>629</h3>
                                </div>
                                <div class="img">
                                    <img src="./img/BTC.png" alt="" srcset="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4 col-xl-3">
                <div class="card" style="background: linear-gradient(to right, #2b5876, #4e4376);">
                    <div class="card-body">
                        <div class="top py-2 d-flex justify-content-between">
                            <div class="img">
                                <img src="./img/1594481.png" alt="" srcset="">
                            </div>
                            <div class="text">
                                <h4>CREDIT</h4>
                            </div>
                        </div>
                        <div class="middle py-2 d-flex justify-content-between">
                            <div class="text">
                                <h4><span><i class='bx bx-dollar'></i></span><span class="counter_up" id="savings_rec"></span></h4>
                            </div>
                            <div class="img">
                                <img src="./img/card chip.png" alt="" srcset="">
                            </div>
                        </div>
                        <div class="bottom pt-2 d-flex justify-content-between">
                            <div class="text cvv">
                                <h4>Card Holder</h4>
                                <h3>সঞ্চয় আদায়</h3>
                            </div>
                            <div class="text d-flex">
                                <div class="cvv">
                                    <h4>Expiry</h4>
                                    <h3>08/26</h3>
                                </div>
                                <div class="cvv mx-2">
                                    <h4>CVV</h4>
                                    <h3>629</h3>
                                </div>
                                <div class="img">
                                    <img src="./img/EURO.png" alt="" srcset="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Dashboard Table -->
<div class="table">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12 pe-4">
                <div class="recent_collection">
                    <div class="table_heading mb-3">
                        <h4>সাম্প্রতিক সঞ্চয় সংগ্রহ <span class="date"></span></h4>
                    </div>
                    <table id="recent_savings_collection" class="table table-bordered table-hover table-striped display responsive nowrap" style="width:100%">
                        <thead>
                            <tr>
                                <th style="max-width: 5%;">#</th>
                                <th style="max-width: 10%;">নাম</th>
                                <th style="max-width: 5%;">বই</th>
                                <th style="max-width: 20%;">ফিল্ড</th>
                                <th style="max-width: 20%;">কেন্দ্র</th>
                                <th style="max-width: 10%;">ক্ষেত্র</th>
                                <th style="max-width: 5%;">সঞ্চয়</th>
                                <th style="max-width: 15%;">অফিসার</th>
                                <th style="max-width: 10%;">সময়</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="col-lg-12 table-scroll pe-4">
                <div class="recent_collection">
                    <div class="table_heading mb-3">
                        <h4>সাম্প্রতিক ঋণ সংগ্রহ <span class="date"></span></h4>
                    </div>
                    <table id="recent_loan_collection" class="table table-bordered table-hover table-striped display responsive nowrap" style="width:100%">
                        <thead>
                            <tr>
                                <th style="max-width: 3%;">#</th>
                                <th style="max-width: 10%;">নাম</th>
                                <th style="max-width: 5%;">বই</th>
                                <th style="max-width: 18%;">ফিল্ড</th>
                                <th style="max-width: 15%;">কেন্দ্র</th>
                                <th style="max-width: 8%;">ক্ষেত্র</th>
                                <th style="max-width: 5%;">সঞ্চয়</th>
                                <th style="max-width: 5%;">ঋণ</th>
                                <th style="max-width: 5%;">লাভ</th>
                                <th style="max-width: 5%;">মোট</th>
                                <th style="max-width: 11%;">অফিসার</th>
                                <th style="max-width: 10%;">সময়</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="col-lg-12 row px-3">
                <div class="col-lg-6 col-md-12 ps-md-0">
                    <div class="recent_collection">
                        <div class="table_heading mb-3">
                            <h4>সাম্প্রতিক সাধারণ সঞ্চয় উত্তোলন <span class="date"></span></h4>
                        </div>
                        <table id="savings_withdrawal_table" class="table table-bordered display responsive nowrap table-hover table-striped" style="width:100%;">
                            <thead>
                                <tr>
                                    <th style="max-width: 2%;">#</th>
                                    <th style="max-width: 10%;">সদস্য</th>
                                    <th style="max-width: 5%;">বই</th>
                                    <th style="max-width: 20%;">ফিল্ড</th>
                                    <th style="max-width: 20%;">কেন্দ্র</th>
                                    <th style="max-width: 20%;">ক্ষেত্র</th>
                                    <th style="max-width: 3%;">উত্তোলন</th>
                                    <th style="max-width: 20%;">অফিসার</th>
                                </tr>
                            </thead>
                            <tfoot>
                                <tr>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td class="text-end" style="border-top: 1px solid #fff;">সর্বমোট</td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
                <div class="col-lg-6 col-md-12 pe-md-0">
                    <div class="recent_collection">
                        <div class="table_heading mb-3">
                            <h4>সাম্প্রতিক ঋণ সঞ্চয় উত্তোলন <span class="date"></span></h4>
                        </div>
                        <table id="loan_savings_withdrawal_table" class="table table-bordered display responsive nowrap table-hover table-striped" style="width:100%;">
                            <thead>
                                <tr>
                                    <th style="max-width: 2%;">#</th>
                                    <th style="max-width: 10%;">সদস্য</th>
                                    <th style="max-width: 5%;">বই</th>
                                    <th style="max-width: 20%;">ফিল্ড</th>
                                    <th style="max-width: 20%;">কেন্দ্র</th>
                                    <th style="max-width: 20%;">ক্ষেত্র</th>
                                    <th style="max-width: 3%;">উত্তোলন</th>
                                    <th style="max-width: 20%;">অফিসার</th>
                                </tr>
                            </thead>
                            <tfoot>
                                <tr>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td class="text-end" style="border-top: 1px solid #fff;">সর্বমোট</td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
                <div class="col-lg-6 col-md-12 ps-md-0">
                    <div class="recent_collection">
                        <div class="table_heading mb-3">
                            <h4>অফিসার কর্তৃক সাম্প্রতিক সর্বমোট সঞ্চয় সংগ্রহ <span class="date"></span></h4>
                        </div>
                        <table id="officers_savings_collection" class="table table-bordered display responsive nowrap table-hover table-striped" style="width:100%">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>অফিসার</th>
                                    <th>সংগ্রহ</th>
                                </tr>
                            </thead>
                            <tfoot>
                                <tr>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td class="text-end" style="border-top: 1px solid #fff;">সর্বমোট</td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
                <div class="col-lg-6 col-md-12 pe-md-0">
                    <div class="recent_collection">
                        <div class="table_heading mb-3">
                            <h4>অফিসার কর্তৃক সাম্প্রতিক সর্বমোট ঋণ সংগ্রহ <span class="date"></span></h4>
                        </div>
                        <table id="officers_loan_collection" class="table table-bordered display responsive nowrap table-hover table-striped" style="width:100%">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>অফিসার</th>
                                    <th>সঞ্চয়</th>
                                    <th>ঋণ</th>
                                    <th>লাভ</th>
                                    <th>সর্বমোট</th>
                                </tr>
                            </thead>
                            <tfoot>
                                <tr>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td class="text-end" style="border-top: 1px solid #fff;">সর্বমোট</td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                    <td style="border-top: 1px solid #fff;"></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<?php
include "include/footer.php";
?>
<script>
    $(document).ready(function() {
        function cardLoad() {
            $.ajax({
                url: "codes/dashboardauthenticate.php",
                type: "POST",
                data: {
                    card: 1
                },
                dataType: "JSON",
                success: function(data) {
                    // console.log(data);
                    if (data != false) {
                        $.each(data, function(key, value) {
                            $("#loan_giving").text(value.total_loan);
                            $("#loan_rec").text(value.total_loan_collection);
                            $("#dps_rec").text(value.total_dps_collection);
                            $("#savings_rec").text(value.Total_savings_collection);
                        })
                    } else {
                        $("#loan_giving").text(0);
                        $("#loan_rec").text(0);
                        $("#dps_rec").text(0);
                        $("#savings_rec").text(0);
                    }
                }
            })
        }

        function savingsreportLoad() {
            $('#recent_savings_collection').DataTable({
                // "processing": true,
                // "serverSide": true,
                "fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                    // Bold the grade for all 'A' grade browsers
                    if (aData[4] == "A") {
                        $('td:eq(4)', nRow).html('<b>A</b>');
                    }
                },
                "responsive": true,
                columnDefs: [{
                        responsivePriority: 1,
                        targets: 1
                    },
                    {
                        responsivePriority: 2,
                        targets: 2
                    },
                    {
                        responsivePriority: 3,
                        targets: 5
                    },
                    {
                        responsivePriority: 4,
                        targets: 6
                    },
                    {
                        responsivePriority: 5,
                        targets: 8
                    }
                ],
                // "retrieve": true,
                "paging": true,
                "bDestroy": true,
                "order": [],
                "searching": true,
                "ajax": {
                    url: "codes/dashboadRecentSavingsLoad.php",
                    type: "POST"
                }
            });
        }

        function loanreportLoad(officer = null) {
            $('#recent_loan_collection').DataTable({
                // "processing": true,
                // "serverSide": true,
                "fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                    // Bold the grade for all 'A' grade browsers
                    if (aData[4] == "A") {
                        $('td:eq(4)', nRow).html('<b>A</b>');
                    }
                },
                "responsive": true,
                columnDefs: [{
                        responsivePriority: 1,
                        targets: 1
                    },
                    {
                        responsivePriority: 2,
                        targets: 2
                    },
                    {
                        responsivePriority: 3,
                        targets: 5
                    },
                    {
                        responsivePriority: 4,
                        targets: 6
                    },
                    {
                        responsivePriority: 5,
                        targets: 7
                    },
                    {
                        responsivePriority: 6,
                        targets: 8
                    },
                    {
                        responsivePriority: 7,
                        targets: 8
                    },
                    {
                        responsivePriority: 8,
                        targets: 11
                    }
                ],
                // "retrieve": true,
                "paging": true,
                "bDestroy": true,
                "order": [],
                "searching": true,
                "ajax": {
                    url: "codes/dashboadRecentloanLoad.php",
                    type: "POST"
                }
            });
        }

        function officers_savings_collection() {
            $('#officers_savings_collection').DataTable({
                "fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                    // Bold the grade for all 'A' grade browsers
                    if (aData[4] == "A") {
                        $('td:eq(4)', nRow).html('<b>A</b>');
                    }
                },
                footerCallback: function(row, data, start, end, display) {
                    var api = this.api();

                    // Remove the formatting to get integer data for summation
                    var intVal = function(i) {
                        return typeof i === 'string' ? i.replace(/[\$,]/g, '') * 1 : typeof i === 'number' ? i : 0;
                    };

                    // Total over all pages
                    total = api
                        .column(2)
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);

                    // Total over this page
                    depositTotal = api
                        .column(2, {
                            page: 'current'
                        })
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);

                    // Update footer
                    $(api.column(2).footer()).html('৳' + depositTotal + "/-");
                },
                "responsive": true,
                columnDefs: [{
                        responsivePriority: 1,
                        targets: 1
                    },
                    {
                        responsivePriority: 2,
                        targets: 2
                    }
                ],
                "paging": false,
                "bDestroy": true,
                "order": [],
                "searching": true,
                "ajax": {
                    url: "codes/dashboadofficersSavingsTotal.php",
                    type: "POST"
                }
            });
        }

        function officers_loan_collection() {
            $('#officers_loan_collection').DataTable({
                "fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                    // Bold the grade for all 'A' grade browsers
                    if (aData[4] == "A") {
                        $('td:eq(4)', nRow).html('<b>A</b>');
                    }
                },
                responsive: true,
                footerCallback: function(row, data, start, end, display) {
                    var api = this.api();

                    // Remove the formatting to get integer data for summation
                    var intVal = function(i) {
                        return typeof i === 'string' ? i.replace(/[\$,]/g, '') * 1 : typeof i === 'number' ? i : 0;
                    };

                    // Total over all pages
                    total = api
                        .column(2)
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);
                    total = api
                        .column(3)
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);
                    total = api
                        .column(4)
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);
                    total = api
                        .column(5)
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);

                    // Total over this page
                    depositTotal = api
                        .column(2, {
                            page: 'current'
                        })
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);
                    loanTotal = api
                        .column(3, {
                            page: 'current'
                        })
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);
                    interestTotal = api
                        .column(4, {
                            page: 'current'
                        })
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);
                    toalTotal = api
                        .column(5, {
                            page: 'current'
                        })
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);

                    // Update footer
                    $(api.column(2).footer()).html('৳' + depositTotal + "/-");
                    $(api.column(3).footer()).html('৳' + loanTotal + "/-");
                    $(api.column(4).footer()).html('৳' + interestTotal + "/-");
                    $(api.column(5).footer()).html('৳' + toalTotal + "/-");
                },
                "responsive": true,
                columnDefs: [{
                        responsivePriority: 1,
                        targets: 1
                    },
                    {
                        responsivePriority: 2,
                        targets: 2
                    },
                    {
                        responsivePriority: 3,
                        targets: 3
                    },
                    {
                        responsivePriority: 4,
                        targets: 4
                    },
                    {
                        responsivePriority: 5,
                        targets: 5
                    }
                ],
                "paging": false,
                "bDestroy": true,
                "order": [],
                "searching": true,
                "ajax": {
                    url: "codes/dashboadofficersloanTotal.php",
                    type: "POST"
                }
            });
        }

        function savings_withdrawal_table(officer = null) {
            $('#savings_withdrawal_table').DataTable({
                // "processing": true,
                // "serverSide": true,
                "fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                    // Bold the grade for all 'A' grade browsers
                    if (aData[4] == "A") {
                        $('td:eq(4)', nRow).html('<b>A</b>');
                    }
                },
                responsive: true,
                footerCallback: function(row, data, start, end, display) {
                    var api = this.api();

                    // Remove the formatting to get integer data for summation
                    var intVal = function(i) {
                        return typeof i === 'string' ? i.replace(/[\$,]/g, '') * 1 : typeof i === 'number' ? i : 0;
                    };

                    // Total over all pages
                    total = api
                        .column(6)
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);

                    // Total over this page
                    depositTotal = api
                        .column(6, {
                            page: 'current'
                        })
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);

                    // Update footer
                    $(api.column(6).footer()).html('৳' + depositTotal + "/-");
                },
                "responsive": true,
                columnDefs: [{
                        responsivePriority: 1,
                        targets: 1
                    },
                    {
                        responsivePriority: 2,
                        targets: 2
                    },
                    {
                        responsivePriority: 3,
                        targets: 5
                    },
                    {
                        responsivePriority: 4,
                        targets: 6
                    },
                    {
                        responsivePriority: 5,
                        targets: 7
                    }
                ],
                "paging": false,
                "bDestroy": true,
                "order": [],
                "searching": true,
                "ajax": {
                    url: "codes/dashboadRecentSavingsWithd.php",
                    type: "POST"
                }
            });
        }

        function loan_savings_withdrawal_table(officer = null) {
            $('#loan_savings_withdrawal_table').DataTable({
                // "processing": true,
                // "serverSide": true,
                "fnRowCallback": function(nRow, aData, iDisplayIndex, iDisplayIndexFull) {
                    // Bold the grade for all 'A' grade browsers
                    if (aData[4] == "A") {
                        $('td:eq(4)', nRow).html('<b>A</b>');
                    }
                },
                responsive: true,
                footerCallback: function(row, data, start, end, display) {
                    var api = this.api();

                    // Remove the formatting to get integer data for summation
                    var intVal = function(i) {
                        return typeof i === 'string' ? i.replace(/[\$,]/g, '') * 1 : typeof i === 'number' ? i : 0;
                    };

                    // Total over all pages
                    total = api
                        .column(6)
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);

                    // Total over this page
                    depositTotal = api
                        .column(6, {
                            page: 'current'
                        })
                        .data()
                        .reduce(function(a, b) {
                            return intVal(a) + intVal(b);
                        }, 0);

                    // Update footer
                    $(api.column(6).footer()).html('৳' + depositTotal + "/-");
                },
                "responsive": true,
                columnDefs: [{
                        responsivePriority: 1,
                        targets: 1
                    },
                    {
                        responsivePriority: 2,
                        targets: 2
                    },
                    {
                        responsivePriority: 3,
                        targets: 5
                    },
                    {
                        responsivePriority: 4,
                        targets: 6
                    },
                    {
                        responsivePriority: 5,
                        targets: 7
                    }
                ],
                // "retrieve": true,
                "paging": false,
                "bDestroy": true,
                "order": [],
                "searching": true,
                "ajax": {
                    url: "codes/dashboadRecentLoanWithd.php",
                    type: "POST"
                }
            });
        }

        cardLoad();
        savingsreportLoad();
        loanreportLoad();
        officers_savings_collection();
        officers_loan_collection();
        savings_withdrawal_table();
        loan_savings_withdrawal_table();
    })
</script>
</body>

</html>